packages:
  yum:
    certbot: []
    mod_ssl: []

files:
  /etc/cron.d/certbot_renew:
    content: "@weekly root certbot renew\n"
    group: root
    mode: "000644"
    owner: root
  /home/ec2-user/setup.sh:
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Here the container variables will be visible as environment variables.
      sudo certbot certonly --non-interactive --email $EMAIL --agree-tos --standalone --domains $DOMAIN --force-renewal


commands:
  01_getcert:
    command: /home/ec2-user/setup.sh
    ignoreErrors: true
